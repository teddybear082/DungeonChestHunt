[gd_scene load_steps=42 format=2]

[ext_resource path="res://addons/godot-xr-tools/assets/PlayerBody.tscn" type="PackedScene" id=1]
[ext_resource path="res://addons/godot-xr-tools/assets/LeftHand.tscn" type="PackedScene" id=2]
[ext_resource path="res://addons/godot-openxr/scenes/first_person_controller_vr.tscn" type="PackedScene" id=3]
[ext_resource path="res://addons/godot-xr-tools/assets/RightHand.tscn" type="PackedScene" id=4]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_Turn_movement.tscn" type="PackedScene" id=5]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_Direct_movement.tscn" type="PackedScene" id=6]
[ext_resource path="res://addons/godot-xr-tools/interactables/DoorsDemo.tscn" type="PackedScene" id=7]
[ext_resource path="res://drop_in_avatar/XR-avatar-subscene.tscn" type="PackedScene" id=8]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_Climb_movement.tscn" type="PackedScene" id=9]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_JumpDetect_movement.tscn" type="PackedScene" id=10]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_Glide_movement.tscn" type="PackedScene" id=11]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_Grapple_movement.tscn" type="PackedScene" id=12]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_Max_Payne_Dive_movement.tscn" type="PackedScene" id=13]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_Pickup.tscn" type="PackedScene" id=14]
[ext_resource path="res://addons/godot-xr-tools/functions/Function_BulletTime_movement.tscn" type="PackedScene" id=15]
[ext_resource path="res://scenes/OverlayHelper.tscn" type="PackedScene" id=16]
[ext_resource path="res://scenes/HolsterHelper.tscn" type="PackedScene" id=17]
[ext_resource path="res://scenes/Floor.tscn" type="PackedScene" id=18]
[ext_resource path="res://materials/level4wallmaterial.tres" type="Material" id=19]
[ext_resource path="res://scenes/BackgroundMountains.tscn" type="PackedScene" id=20]
[ext_resource path="res://sounds/sfx100v2_thunder_01.ogg" type="AudioStream" id=21]
[ext_resource path="res://sounds/Very__Warm_840.mp3" type="AudioStream" id=22]
[ext_resource path="res://sounds/Fire and Thunder.mp3" type="AudioStream" id=23]
[ext_resource path="res://GameLevels/GameLevel4.gd" type="Script" id=24]
[ext_resource path="res://sounds/Welcome_to_the_final_317.mp3" type="AudioStream" id=25]
[ext_resource path="res://scenes/TitleTable.tscn" type="PackedScene" id=26]
[ext_resource path="res://scenes/PickableHandGun.tscn" type="PackedScene" id=27]
[ext_resource path="res://sounds/V_22P.mp3" type="AudioStream" id=28]
[ext_resource path="res://scenes/PickableHandGun.gd" type="Script" id=29]
[ext_resource path="res://scenes/handgun_model_mesh.tscn" type="PackedScene" id=30]
[ext_resource path="res://scenes/Bullet.tscn" type="PackedScene" id=31]
[ext_resource path="res://scenes/Casing.tscn" type="PackedScene" id=32]

[sub_resource type="Environment" id=1]
background_mode = 1
ambient_light_color = Color( 0.984314, 0.988235, 0.941176, 1 )

[sub_resource type="CubeMesh" id=2]
size = Vector3( 50, 0.5, 150 )

[sub_resource type="ConvexPolygonShape" id=3]
points = PoolVector3Array( -25.2876, 0.615272, -75.2885, 25.4808, 0.615272, 75.2885, -25.2876, 0.615272, 75.2885, 25.4808, 0.615272, -75.2885 )

[sub_resource type="CubeMesh" id=4]
size = Vector3( 0.5, 15, 150 )

[sub_resource type="ConvexPolygonShape" id=5]
points = PoolVector3Array( -0.447368, 7.69737, 75.1974, -0.447368, -7.69737, -75.1974, -0.447368, 7.69737, -75.1974, -0.447368, -7.69737, 75.1974 )

[sub_resource type="ConvexPolygonShape" id=6]
points = PoolVector3Array( 0, 0.588374, -2.34742, -0.127419, 0.590591, -2.34742, 0.127358, 0.590591, -2.34742, 0, 0.588374, -1.46111, -0.257628, 0.720198, -2.34742, -0.127419, 0.590591, -1.46111, -0.281838, 0.717734, -1.46111, 0.257568, 0.720198, -2.34742, 0.281777, 0.717734, -1.46111, 0.127358, 0.590591, -1.46111, 0.30987, 0.853829, 1.87581, -0.309931, 0.853829, 1.87581, -0.276681, 0.718309, -1.65044, -0.309931, 0.853829, -1.46111, -0.306958, 1.0112, -2.34742, 0.306897, 1.0112, -2.34742, 0.30987, 0.853829, -1.46111, 0.27662, 0.718309, -1.65044, 0.30987, 1.23205, 1.77659, 0.114555, 1.42745, 1.72657, 0.309931, 0.965695, -1.65044, 0, 1.42745, 1.72657, -0.309931, 1.23205, 1.77659, -0.309931, 1.01243, -1.84432, -0.306958, 1.23008, -2.34742, 0.306897, 1.23008, -2.34742, 0.30987, 1.01243, -1.84432, 0.252653, 1.3702, 1.74063, 0.30987, 1.23205, -0.26061, 0.114555, 1.42745, -2.34742, 0, 1.42745, -2.34742, -0.110369, 1.41455, 1.72657, -0.251925, 1.36782, 1.74063, -0.25332, 1.36552, -2.34742, -0.309931, 1.23205, -0.000172138, 0.252168, 1.36207, -2.34742, 0.252653, 1.3702, -0.32758, 0.28202, 1.29924, -0.32758, -0.109823, 1.41291, -2.34742 )

[sub_resource type="ConvexPolygonShape" id=7]
points = PoolVector3Array( -0.183356, -1.51646, 1.33739, 0.183294, -1.51646, 1.33739, -0.317163, -1.49922, 1.46411, -0.183356, 0.579643, -1.46515, 0.317163, -1.49922, 1.46411, 0, 0.579643, -1.46515, 0.183294, 0.579643, -1.46066, -0.317163, -1.3918, 2.25325, -0.317163, 0.722941, -1.46515, 0.317163, -1.3918, 2.25325, 0.317163, 0.723407, -1.46066, 0.317163, 0.863676, -1.46066, -0.209248, -1.37806, 2.35381, -0.317163, 0.655836, 2.19755, -0.317163, 0.863676, -1.46066, 0.317163, 0.655836, 2.19755, 0.209186, -1.37806, 2.35381, -0.145915, 0.863909, 1.41215, 0.317163, 0.863676, 1.86859, -0.209248, 0.568226, 2.20914, -0.317163, 0.863676, 1.86859, 0.209186, 0.568226, 2.20914 )

[sub_resource type="ConvexPolygonShape" id=8]
points = PoolVector3Array( 0.201387, -1.44475, 2.37661, 0.207344, -1.36958, 2.3393, 0.27683, 0.79677, 1.48812, -0.201442, -1.44475, 2.37661, 0.112358, -1.45747, 2.3001, 0.214916, -1.6104, 1.37415, 0.220874, -1.53617, 1.33999, -0.276886, 0.79677, 1.48812, 0.284347, 0.619814, 0.768388, -0.22093, -1.53617, 1.33999, -0.214972, -1.6104, 1.37415, -0.112413, -1.45747, 2.3001, -0.2074, -1.36958, 2.3393, 0.119874, -1.59838, 1.44703, -0.284402, 0.619814, 0.768388, -0.11993, -1.59838, 1.44703 )

[sub_resource type="BoxShape" id=9]
margin = 0.01
extents = Vector3( 0.03, 0.03, 0.1 )

[node name="GameLevel4" type="Spatial"]
script = ExtResource( 24 )

[node name="FPController" parent="." instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.167633, 15 )

[node name="ARVRCamera" parent="FPController" index="1"]
far = 1000.0

[node name="LeftHand" parent="FPController/LeftHandController" index="0" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.03, -0.05, 0.15 )

[node name="Hand_Left" parent="FPController/LeftHandController/LeftHand/LeftHand/Armature_Left/Skeleton" index="0"]
visible = false

[node name="Function_Direct_movement" parent="FPController/LeftHandController" index="1" instance=ExtResource( 6 )]
strafe = true

[node name="Function_Grapple_movement" parent="FPController/LeftHandController" index="2" instance=ExtResource( 12 )]
grapple_collision_mask = 2
grapple_button_id = 7

[node name="Function_BulletTime_movement" parent="FPController/LeftHandController" index="3" instance=ExtResource( 15 )]

[node name="SloMo_Sound" parent="FPController/LeftHandController/Function_BulletTime_movement" index="1"]
stream = ExtResource( 22 )

[node name="Function_Pickup" parent="FPController/LeftHandController" index="4" instance=ExtResource( 14 )]
grab_distance = 0.1
grab_collision_mask = 10
ranged_collision_mask = 2

[node name="RightHand" parent="FPController/RightHandController" index="0" instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.03, -0.05, 0.15 )

[node name="Hand_Left" parent="FPController/RightHandController/RightHand/RightHand/Armature_Left/Skeleton" index="0"]
visible = false

[node name="RightHandIKTarget" type="Spatial" parent="FPController/RightHandController/RightHand"]
transform = Transform( -4.37114e-08, 1, 0, 4.37114e-08, 1.91069e-15, 1, 1, 4.37114e-08, -4.37114e-08, 0, 0, 0 )

[node name="Function_Turn_movement" parent="FPController/RightHandController" index="1" instance=ExtResource( 5 )]
smooth_rotation = true

[node name="Function_Grapple_movement" parent="FPController/RightHandController" index="2" instance=ExtResource( 12 )]
grapple_collision_mask = 2
grapple_button_id = 7

[node name="Function_Max_Payne_Dive_movement" parent="FPController/RightHandController" index="3" instance=ExtResource( 13 )]

[node name="MP_Sound" parent="FPController/RightHandController/Function_Max_Payne_Dive_movement" index="1"]
stream = ExtResource( 21 )

[node name="Function_Pickup" parent="FPController/RightHandController" index="4" instance=ExtResource( 14 )]
grab_distance = 0.1
grab_collision_mask = 10
ranged_collision_mask = 2

[node name="PlayerBody" parent="FPController" instance=ExtResource( 1 )]

[node name="Function_Climb_movement" parent="FPController" instance=ExtResource( 9 )]
left_pickup = NodePath("../LeftHandController/Function_Pickup")
right_pickup = NodePath("../RightHandController/Function_Pickup")

[node name="Function_Glide_movement" parent="FPController" instance=ExtResource( 11 )]

[node name="Function_JumpDetect_Movement" parent="FPController" instance=ExtResource( 10 )]

[node name="avatar" parent="FPController" instance=ExtResource( 8 )]
left_hand_path = NodePath("../LeftHandController/LeftHand")
right_hand_path = NodePath("../RightHandController/RightHand")

[node name="HolsterHelper" parent="." instance=ExtResource( 17 )]

[node name="OverlayHelper" parent="." instance=ExtResource( 16 )]

[node name="Floor" parent="." instance=ExtResource( 18 )]
collision_layer = 3

[node name="Floor3" parent="." instance=ExtResource( 18 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -100 )
collision_layer = 3

[node name="Floor2" parent="." instance=ExtResource( 18 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -50 )
collision_layer = 3

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource( 1 )

[node name="Ceiling" type="StaticBody" parent="."]

[node name="CeilingMesh" type="MeshInstance" parent="Ceiling"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 15, -50 )
mesh = SubResource( 2 )
skeleton = NodePath("../..")
material/0 = ExtResource( 19 )

[node name="CollisionShape" type="CollisionShape" parent="Ceiling"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 15, -50 )
shape = SubResource( 3 )

[node name="Wall" type="StaticBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -25, 7.5, -50 )

[node name="MeshInstance" type="MeshInstance" parent="Wall"]
mesh = SubResource( 4 )
material/0 = ExtResource( 19 )

[node name="CollisionShape" type="CollisionShape" parent="Wall"]
shape = SubResource( 5 )

[node name="Wall2" type="StaticBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 25, 7.5, -50 )

[node name="MeshInstance" type="MeshInstance" parent="Wall2"]
mesh = SubResource( 4 )
material/0 = ExtResource( 19 )

[node name="CollisionShape" type="CollisionShape" parent="Wall2"]
shape = SubResource( 5 )

[node name="BackgroundMountains" parent="." instance=ExtResource( 20 )]
transform = Transform( 0.412309, 0, -0.911044, 0, 1, 0, 0.911044, 0, 0.412309, 0, 2.56853, 33.2363 )

[node name="BackgroundMountains2" parent="." instance=ExtResource( 20 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.144068, -139.837 )

[node name="DoorsDemo" parent="." instance=ExtResource( 7 )]

[node name="BackgroundMusic" type="AudioStreamPlayer" parent="."]
stream = ExtResource( 23 )
autoplay = true

[node name="Voiceovers" type="AudioStreamPlayer" parent="."]
stream = ExtResource( 25 )

[node name="TitleTable" parent="." instance=ExtResource( 26 )]
transform = Transform( 0.3, 0, 0, 0, 0.3, 0, 0, 0, 0.3, 0, 0, 9.68406 )

[node name="PickableHandGun" parent="." instance=ExtResource( 27 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.770061, 1.01704, 10.0706 )

[node name="PickableHandGun2" type="RigidBody" parent="." groups=["weapons"]]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.827, 1.205, 10.085 )
collision_layer = 131074
collision_mask = 131074
script = ExtResource( 29 )
bullet_scene = ExtResource( 31 )
casing_scene = ExtResource( 32 )
bullet_speed = 100.0

[node name="PickupCenter" type="Spatial" parent="PickableHandGun2"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.04, -0.02 )

[node name="CollisionShape" type="CollisionShape" parent="PickableHandGun2"]
transform = Transform( 0.05, 0, 0, 0, 0.05, 0, 0, 0, 0.05, 0, 0, 0 )
shape = SubResource( 6 )

[node name="CollisionShape2" type="CollisionShape" parent="PickableHandGun2"]
transform = Transform( 0.05, 0, 0, 0, 0.05, 0, 0, 0, 0.05, 0, 0, 0 )
shape = SubResource( 7 )

[node name="CollisionShape3" type="CollisionShape" parent="PickableHandGun2"]
transform = Transform( 0.05, 0, 0, 0, 0.05, 0, 0, 0, 0.05, 0, 0, 0 )
shape = SubResource( 8 )

[node name="handgun_model_mesh" parent="PickableHandGun2" instance=ExtResource( 30 )]

[node name="BulletSpawnPoint" type="Spatial" parent="PickableHandGun2"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.050537, -0.162184 )

[node name="ShotTimer" type="Timer" parent="PickableHandGun2"]
wait_time = 0.25

[node name="GunSound" type="AudioStreamPlayer3D" parent="PickableHandGun2"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0873425, 0.057828 )
stream = ExtResource( 28 )

[node name="CasingSpawnPoint" type="Spatial" parent="PickableHandGun2"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0275362, 0.0833555, 0 )

[node name="KinematicBody" type="KinematicBody" parent="PickableHandGun2"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0522672, -0.0228236 )
collision_layer = 0
collision_mask = 8

[node name="CollisionShape" type="CollisionShape" parent="PickableHandGun2/KinematicBody"]
shape = SubResource( 9 )

[connection signal="timeout" from="PickableHandGun2/ShotTimer" to="PickableHandGun2" method="_on_ShotTimer_timeout"]

[editable path="FPController"]
[editable path="FPController/LeftHandController/LeftHand"]
[editable path="FPController/LeftHandController/LeftHand/LeftHand"]
[editable path="FPController/LeftHandController/Function_BulletTime_movement"]
[editable path="FPController/RightHandController/RightHand"]
[editable path="FPController/RightHandController/RightHand/RightHand"]
[editable path="FPController/RightHandController/Function_Max_Payne_Dive_movement"]
